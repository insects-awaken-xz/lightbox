!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.lightbox=i()}(this,function(){"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}var o,r,c,l,h=function(i,e){var s;return function(t){s||(s=setTimeout(function(){e(t),s=0},i))}},d=function(t){return t.preventDefault()},u="xlb",m="xlb-backdrop",p="xlb-img",b="xlb-album",g="xlb-arrow",v="xlb-arrow-right",f="xlb-arrow-left",$="xlb-hide",y="xlb-locked",w="xlb-force-transparent",x="disappeared",L="showing",k="showed",_="disappearing",E={onDisappeared:void 0,onShowing:void 0,onShowed:void 0,onDisappearing:void 0},C={hide:!1,duration:618,offset:100};return new(function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.initial=C,Object.defineProperty(this.option(),"status",{set:this._statusHandle,get:function(){return status},enumerable:!0})}var i,e,s;return i=t,(e=[{key:"option",value:function(i){return Object.keys(i||{}).map(function(t){if(Object.hasOwnProperty.call(E,t)&&"function"!=typeof i[t])throw TypeError("".concat(t," has to be a function."))}),this.opts=Object.assign({},this.initial,i),this.$lightbox&&this._setDuration(),this}},{key:"_build",value:function(){this.$lightbox||(this.calc={},this.album=[],this.isAlbum=!1,this.$lightbox=document.createElement("div"),this.$lightbox.id=u,this.$lightbox.classList.add(u,$),this.$backdrop=document.createElement("div"),this.$backdrop.classList.add(m,w),this.$albumName=document.createElement("h1"),this.$albumName.classList.add(b,$,w),this.$img=document.createElement("img"),this.$img.classList.add(p),this.$arrowR=document.createElement("div"),this.$arrowR.classList.add(g,v,$,w),this.$arrowL=document.createElement("div"),this.$arrowL.classList.add(g,f,$,w),this.$lightbox.appendChild(this.$backdrop),this.$lightbox.appendChild(this.$img),this.$lightbox.appendChild(this.$albumName),this.$lightbox.appendChild(this.$arrowR),this.$lightbox.appendChild(this.$arrowL),document.body.appendChild(this.$lightbox),this._setDuration(),o=h(17,this._active.bind(this)),r=h(17,this._keyboard.bind(this)),c=h(17,this._prevPage.bind(this)),l=h(17,this._nextPage.bind(this)))}},{key:"_setDuration",value:function(){this.$img.style.transition="transform ".concat(this.opts.duration,"ms ease"),this.$albumName.style.transition=this.$arrowR.style.transition=this.$arrowL.style.transition=this.$backdrop.style.transition="opacity ".concat(this.opts.duration,"ms ease")}},{key:"_listen",value:function(){var t=this;this.$img.addEventListener("transitionend",function(){return t.status=t.status===L?k:t.status===_?x:""}),this.$backdrop.addEventListener("click",function(){return t.status=_})}},{key:"_inactive",value:function(){var t=this.$el.getBoundingClientRect();this.calc.elW=t.width,this.calc.elH=t.height,this.$img.style.width="".concat(this.calc.elW,"px"),this.$img.style.height="".concat(this.calc.elH,"px"),this.$img.style.transform="translate(".concat(t.left,"px, ").concat(t.top,"px) scale(1, 1)"),this.$backdrop.classList.add(w)}},{key:"_active",value:function(){var t=this.$lightbox.getBoundingClientRect(),i=t.width-this.opts.offset,e=t.height-this.opts.offset;this.calc.originW<=i&&this.calc.originH<=e?this.calc.lastW=this.calc.originW:(this.calc.lastW=i,this.calc.lastW*this.calc.originRatio>e&&(this.calc.lastW=e/this.calc.originRatio));var s=this.calc.lastW/this.calc.elW,a=this.calc.lastW*this.calc.originRatio/this.calc.elH,n=(i+this.opts.offset-this.calc.elW)/2,o=(e+this.opts.offset-this.calc.elH)/2;this.$img.style.transform="translate(".concat(n,"px, ").concat(o,"px) scale(").concat(s,", ").concat(a,")"),this.$backdrop.classList.remove(w)}},{key:"_statusHandle",value:function(t){status=t,this.status===x?(this.opts.onDisappeared&&this.opts.onDisappeared(),this.opts.hide&&this.$el.classList.remove(w),this.$lightbox.classList.add($),this.$img.style.willChange="auto",document.documentElement.classList.remove(y),window.removeEventListener("touchmove",d),window.removeEventListener("resize",o),this.calc={},this.$el=void 0,this.isAlbum&&(this.album=[],this.$arrowR.classList.add($),this.$arrowL.classList.add($),this.$albumName.classList.add($))):(this.status===L?(this.opts.onShowing&&this.opts.onShowing(),this.opts.hide&&this.$el.classList.add(w),this.$lightbox.classList.remove($),this._active(),this.isAlbum&&(this.$arrowR.classList.remove($,w),this.$arrowL.classList.remove($,w),this.$albumName.classList.remove($,w))):this.status===k?this.opts.onShowed&&this.opts.onShowed():this.status===_&&(this.opts.onDisappearing&&this.opts.onDisappearing(),this._inactive(),this.isAlbum&&(this.$arrowL.removeEventListener("click",c),this.$arrowR.removeEventListener("click",l),this.$img.removeEventListener("click",l),window.removeEventListener("keydown",r),this.$arrowR.classList.add(w),this.$arrowL.classList.add(w),this.$albumName.classList.add(w))),this.$img.style.willChange="transform",document.documentElement.classList.add(y),window.addEventListener("touchmove",d),window.addEventListener("resize",o))}},{key:"_keyboard",value:function(t){27!==t.keyCode?37===t.keyCode||65===t.keyCode?this._prevPage():39!==t.keyCode&&68!==t.keyCode&&13!==t.keyCode&&32!==t.keyCode||this._nextPage():this.status=_}},{key:"_prevPage",value:function(){this.activeIndex=--this.activeIndex<0?this.album.length-1:this.activeIndex,this._update(this.album[this.activeIndex])}},{key:"_nextPage",value:function(){this.activeIndex=++this.activeIndex>this.album.length-1?0:this.activeIndex,this._update(this.album[this.activeIndex])}},{key:"_update",value:function(t){var i=this;this.$el=t,this._inactive();var e=new Image,s=this.$el.getAttribute("src");e.src=s,e.onload=function(){i.$img.src=s,i.calc.originW=e.width,i.calc.originH=e.height,i.calc.originRatio=e.height/e.width,i.$img.onload=function(){return i.status=L}},e.onerror=console.error}},{key:"start",value:function(){var e=this;this._build(),this._listen(),window.addEventListener("click",function(t){var i=t.target;if(e.albumName=i.getAttribute("xz-lightbox"),i.tagName&&"IMG"===i.tagName.toUpperCase()&&"object"!==a(e.albumName)){if(e.album=document.querySelectorAll('img[xz-lightbox="'.concat(e.albumName,'"]')),e.isAlbum=1<e.album.length,e.isAlbum){if(e.activeIndex=Array.prototype.indexOf.call(e.album,i),-1===e.activeIndex)return;e.$albumName.innerText=e.albumName,e.$arrowL.addEventListener("click",c),e.$arrowR.addEventListener("click",l),e.$img.addEventListener("click",l),e.$img.setAttribute("title","Next page!"),window.addEventListener("keydown",r)}e._update(i)}})}}])&&n(i.prototype,e),s&&n(i,s),t}())});
