!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.amd?define(i):t.lightbox=i()}(this,function(){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,i){for(var e=0;e<i.length;e++){var o=i[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return new(function(){function t(){var i,e=this;!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(t){return t.preventDefault()},s=function(t){i||(i=setTimeout(function(){e._calcActivePos.bind(e)(t),i=void 0},33))},n="orientationchange"in window?"orientationchange":"resize";this.defaults={hideEl:!1,duration:618,offsetDistance:60,listenAttr:"xz-lightbox",backdropColor:"#000",backdropOpacity:.618},Object.defineProperty(this.option(),"status",{set:function(t){status=t;var i="disappeared"===status;e.$img.style.willChange=i?"auto":"transform",document.documentElement.classList[i?"remove":"add"]("xz-locked"),document.body.classList[i?"remove":"add"]("xz-locked"),window[i?"removeEventListener":"addEventListener"]("touchmove",o,!1),window[i?"removeEventListener":"addEventListener"](n,s,!1)},get:function(){return status}})}var i,e,o;return i=t,(e=[{key:"_buildAndListen",value:function(){var t=this;if(!this.$lightbox){this.calc={},this.$lightbox=document.createElement("div"),this.$lightbox.id="xz-lightbox",this.$lightbox.classList.add("xz-lightbox","hide"),this.$backdrop=document.createElement("div"),this.$backdrop.classList.add("xz-lightbox-backdrop","transparent"),this.$backdrop.style.background=this.opts.backdropColor,this.$backdrop.style.opacity="".concat(this.opts.backdropOpacity),this.$backdrop.style.transition="opacity ".concat(this.opts.duration,"ms ease"),this.$img=document.createElement("img"),this.$img.classList.add("xz-lightbox-img"),this.$img.style.transition="transform ".concat(this.opts.duration,"ms ease, box-shadow ").concat(this.opts.duration,"ms ease"),this.$lightbox.appendChild(this.$backdrop),this.$lightbox.appendChild(this.$img),document.body.appendChild(this.$lightbox);var i=document.createElement("style");i.innerHTML="html.xz-locked{overflow:hidden !important}html img[".concat(this.opts.listenAttr,"]{cursor:zoom-in}html img.xz-force-hide{opacity:0}html .xz-lightbox{position:fixed;top:0;left:0;width:100%;height:100%;z-index:99999}html .xz-lightbox.hide{display:none}html .xz-lightbox .xz-lightbox-backdrop{position:absolute;top:0;left:0;width:inherit;height:inherit}html .xz-lightbox .xz-lightbox-backdrop.transparent{opacity:.01 !important}html .xz-lightbox .xz-lightbox-img{cursor:zoom-out}"),document.body.appendChild(i),this.$img.addEventListener("transitionend",function(){"disappearing"===t.status&&(t.status="disappeared",t.opts.hideEl&&t.$el.classList.remove("xz-force-hide"),t.$lightbox.classList.add("hide"))},!1),this.$lightbox.addEventListener("click",function(){t.status="disappearing",t.$backdrop.classList.add("transparent"),t._calcInactivePos()})}}},{key:"_calcInactivePos",value:function(){var t=this.$el.getBoundingClientRect();this.calc.elW=t.width,this.calc.elH=t.height,this.$img.style.width="".concat(this.calc.elW,"px"),this.$img.style.height="".concat(this.calc.elH,"px"),this.$img.style.transform="translate(".concat(t.left,"px, ").concat(t.top,"px) scale(1, 1)")}},{key:"_calcActivePos",value:function(){var t=this.$lightbox.getBoundingClientRect(),i=t.width-this.opts.offsetDistance,e=t.height-this.opts.offsetDistance;this.calc.originW<=i&&this.calc.originH<=e?this.calc.lastW=this.calc.originW:(this.calc.lastW=i,this.calc.lastW*this.calc.originRatio>e&&(this.calc.lastW=e/this.calc.originRatio));var o=this.calc.lastW/this.calc.elW,s=this.calc.lastW*this.calc.originRatio/this.calc.elH,n=(i+this.opts.offsetDistance-this.calc.elW)/2,a=(e+this.opts.offsetDistance-this.calc.elH)/2;this.$img.style.transform="translate(".concat(n,"px, ").concat(a,"px) scale(").concat(o,", ").concat(s,")")}},{key:"_updateImg",value:function(){var t=this;this._calcInactivePos(),this.$img.src=this.$el.getAttribute("src"),this.$img.onload=function(){t.calc.originW=t.$img.width,t.calc.originH=t.$img.height,t.calc.originRatio=t.$img.height/t.$img.width,t.$lightbox.classList.remove("hide"),t.status="show",t.opts.hideEl&&t.$el.classList.add("xz-force-hide"),t._calcActivePos(),t.$backdrop.classList.remove("transparent")}}},{key:"option",value:function(t){if(t&&-1!=="class_style_src".split("_").indexOf(t.listenAttr))throw new Error("The name of listenAttr should't be class,style or src!");return this.opts=Object.assign({},this.defaults,t),this}},{key:"start",value:function(){var o=this;this._buildAndListen(),window.addEventListener("click",function(t){var i=t.target,e=i.getAttribute(o.opts.listenAttr);i.tagName&&"IMG"===i.tagName.toUpperCase()&&"object"!==s(e)&&(o.$el=i,o._updateImg())},!1)}}])&&n(i.prototype,e),o&&n(i,o),t}())});
